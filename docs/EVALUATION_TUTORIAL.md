# RAG Agent è¯„ä¼°æ•™ç¨‹

å®Œæ•´çš„ RAG ç³»ç»Ÿè¯„ä¼°æŒ‡å—ï¼Œä»æ•°æ®å‡†å¤‡åˆ°ç»“æœè§£è¯»ã€‚

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [è¯„ä¼°æŒ‡æ ‡è¯´æ˜](#è¯„ä¼°æŒ‡æ ‡è¯´æ˜)
3. [å‡†å¤‡è¯„ä¼°æ•°æ®é›†](#å‡†å¤‡è¯„ä¼°æ•°æ®é›†)
4. [æ ‡æ³¨ Gold Doc IDs](#æ ‡æ³¨-gold-doc-ids)
5. [è¿è¡Œè¯„ä¼°](#è¿è¡Œè¯„ä¼°)
6. [è§£è¯»è¯„ä¼°ç»“æœ](#è§£è¯»è¯„ä¼°ç»“æœ)
7. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. è®¾ç½® API Key
# Windows PowerShell:
$env:GOOGLE_API_KEY='your_google_api_key_here'

# Mac/Linux:
export GOOGLE_API_KEY='your_google_api_key_here'
```

### 3åˆ†é’Ÿå¿«é€Ÿè¯„ä¼°

```bash
# è¿›å…¥è¯„ä¼°ç›®å½•
cd evaluation

# è¿è¡Œè¯„ä¼°ï¼ˆä½¿ç”¨ç°æœ‰datasetï¼‰
python run_evaluation.py
```

è¯„ä¼°ç»“æœå°†ä¿å­˜åœ¨ `eval_results/` æ–‡ä»¶å¤¹ä¸­ã€‚

---

## ğŸ“Š è¯„ä¼°æŒ‡æ ‡è¯´æ˜

æœ¬ç³»ç»Ÿæä¾›ä¸‰ç±»äº’è¡¥çš„è¯„ä¼°æŒ‡æ ‡ï¼š

### 1ï¸âƒ£ RAGAS æŒ‡æ ‡ï¼ˆç”Ÿæˆè´¨é‡ï¼‰

è¡¡é‡ LLM ç”Ÿæˆç­”æ¡ˆçš„è´¨é‡ï¼š

| æŒ‡æ ‡ | è¯´æ˜ | èŒƒå›´ | ç›®æ ‡å€¼ |
|------|------|------|--------|
| **Faithfulness** | ç­”æ¡ˆæ˜¯å¦å¿ å®äºæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ | 0-1 | >0.90 |
| **Answer Relevancy** | ç­”æ¡ˆæ˜¯å¦ç›¸å…³äºé—®é¢˜ | 0-1 | >0.75 |
| **Context Precision** | æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡æ˜¯å¦ç²¾å‡† | 0-1 | >0.90 |
| **Context Recall** | æ˜¯å¦æ£€ç´¢åˆ°äº†æ‰€éœ€çš„ä¸Šä¸‹æ–‡ | 0-1 | >0.85 |

**RAGAS å¹³å‡åˆ†**ï¼šå››ä¸ªæŒ‡æ ‡çš„å¹³å‡å€¼ï¼Œç»¼åˆåæ˜ ç³»ç»Ÿè´¨é‡ã€‚

### 2ï¸âƒ£ æ£€ç´¢ç¡¬æŒ‡æ ‡ï¼ˆéœ€è¦ gold_doc_idsï¼‰

å®¢è§‚è¡¡é‡æ£€ç´¢ç³»ç»Ÿæ˜¯å¦å‘½ä¸­äº†æ­£ç¡®çš„æ–‡æ¡£ï¼š

| æŒ‡æ ‡ | è¯´æ˜ | è®¡ç®—æ–¹å¼ | ç›®æ ‡å€¼ |
|------|------|----------|--------|
| **Hit@k** | Top-k ä¸­æ˜¯å¦åŒ…å«è‡³å°‘ä¸€ä¸ªç›¸å…³æ–‡æ¡£ | äºŒå…ƒæŒ‡æ ‡ï¼ˆ0æˆ–1ï¼‰ | Hit@3 >0.95 |
| **Recall@k** | Top-k ä¸­ç›¸å…³æ–‡æ¡£çš„æ¯”ä¾‹ | ç›¸å…³æ–‡æ¡£æ•°/æ€»ç›¸å…³æ–‡æ¡£æ•° | Recall@3 >0.90 |
| **MRR** | ç¬¬ä¸€ä¸ªç›¸å…³æ–‡æ¡£çš„æ’åå€’æ•° | 1/æ’å | >0.75 |

**ç¤ºä¾‹**ï¼š
- å¦‚æœç¬¬1ä¸ªæ£€ç´¢ç»“æœå°±æ˜¯ç›¸å…³çš„ â†’ MRR = 1.0
- å¦‚æœç¬¬2ä¸ªæ£€ç´¢ç»“æœæ‰æ˜¯ç›¸å…³çš„ â†’ MRR = 0.5
- å¦‚æœç¬¬3ä¸ªæ£€ç´¢ç»“æœæ‰æ˜¯ç›¸å…³çš„ â†’ MRR = 0.33

### 3ï¸âƒ£ ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

è¡¡é‡ç³»ç»Ÿçš„è¿è¡Œæ•ˆç‡ï¼š

| æŒ‡æ ‡ | è¯´æ˜ | å•ä½ |
|------|------|------|
| **Latency (p50/p95/mean)** | å“åº”æ—¶é—´çš„åˆ†ä½æ•°å’Œå¹³å‡å€¼ | ç§’ |
| **Tokens (mean/p95)** | Tokenä½¿ç”¨é‡ | ä¸ª |
| **Success Rate** | æˆåŠŸå®Œæˆçš„æŸ¥è¯¢æ¯”ä¾‹ | % |

---

## ğŸ“ å‡†å¤‡è¯„ä¼°æ•°æ®é›†

è¯„ä¼°æ•°æ®é›†ä½äº `evaluation/eval_dataset.json`ï¼Œæ¯ä¸ªé—®é¢˜åŒ…å«ï¼š

```json
{
  "question": "What is the primary mechanism of action of metformin?",
  "ground_truth": "Metformin primarily lowers blood glucose by...",
  "context": [
    "Metformin is widely used as a first-line medication...",
    "Metformin also improves insulin sensitivity..."
  ],
  "gold_doc_ids": ["7"]  // å¯é€‰ï¼Œç”¨äºæ£€ç´¢ç¡¬æŒ‡æ ‡
}
```

### å­—æ®µè¯´æ˜

- **question** (å¿…éœ€): è¦æµ‹è¯•çš„é—®é¢˜
- **ground_truth** (å¿…éœ€): æ ‡å‡†ç­”æ¡ˆï¼Œç”¨äºRAGASè¯„ä¼°
- **context** (å¿…éœ€): å‚è€ƒä¸Šä¸‹æ–‡ï¼Œç”¨äºRAGASè¯„ä¼°
- **gold_doc_ids** (å¯é€‰): ç›¸å…³æ–‡æ¡£çš„chunk IDåˆ—è¡¨ï¼Œç”¨äºæ£€ç´¢ç¡¬æŒ‡æ ‡

### åˆ›å»ºæ–°çš„è¯„ä¼°æ•°æ®é›†

1. **å¤åˆ¶æ¨¡æ¿**ï¼š
   ```bash
   cp evaluation/eval_dataset.json evaluation/my_dataset.json
   ```

2. **ç¼–è¾‘é—®é¢˜**ï¼šæ ¹æ®æ‚¨çš„é¢†åŸŸä¿®æ”¹é—®é¢˜å’Œç­”æ¡ˆ

3. **ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®é›†**ï¼š
   ```python
   python run_evaluation.py --dataset my_dataset.json
   ```

---

## ğŸ¯ æ ‡æ³¨ Gold Doc IDs

`gold_doc_ids` æ˜¯å¯é€‰çš„ï¼Œä½†å¼ºçƒˆæ¨èï¼Œå› ä¸ºå®ƒèƒ½æä¾›å®¢è§‚çš„æ£€ç´¢æŒ‡æ ‡ã€‚

### æ–¹æ³•1ï¼šä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼ˆæ¨èï¼‰â­

```bash
cd evaluation
python annotate_gold_doc_ids.py
```

**å·¥ä½œæµç¨‹**ï¼š

1. å·¥å…·ä¼šé€ä¸ªæ˜¾ç¤ºé—®é¢˜
2. è‡ªåŠ¨è¿è¡ŒRAGæ£€ç´¢ï¼Œæ˜¾ç¤ºæ£€ç´¢åˆ°çš„chunks
3. æ‚¨æ ‡è®°å“ªäº›chunksæ˜¯ç›¸å…³çš„
4. å·¥å…·è‡ªåŠ¨æ›´æ–° `eval_dataset.json`

**æ ‡æ³¨ç¤ºä¾‹**ï¼š

```
======================================================================
Question 1/30
======================================================================

Q: What is the primary mechanism of action of metformin?

Retrieving documents...

======================================================================
RETRIEVED CHUNKS:
======================================================================

[1] Chunk ID: 7
    Source: https://en.wikipedia.org/wiki/Metformin
    Snippet: Metformin decreases gluconeogenesis (glucose production) in the liver...

[2] Chunk ID: 23
    Source: https://en.wikipedia.org/wiki/Metformin
    Snippet: AMPK activation is required for metformin's effect...

[3] Chunk ID: 42
    Source: https://en.wikipedia.org/wiki/Diabetes
    Snippet: Type 2 diabetes is treated with lifestyle changes...

======================================================================
ANNOTATION
======================================================================

Which chunks are RELEVANT to answer this question?

Options:
  - Enter chunk IDs (comma-separated): e.g., 7,23
  - Enter citation numbers: e.g., 1,2
  - Enter 'all' to mark all chunks as relevant
  - Enter 'none' or press Enter to skip

Your selection: 1,2

âœ“ Added gold_doc_ids: ['7', '23']
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨ç¼–è¾‘

å¦‚æœæ‚¨çŸ¥é“ç›¸å…³çš„chunk IDsï¼Œå¯ä»¥ç›´æ¥ç¼–è¾‘JSONï¼š

```json
{
  "question": "What is metformin?",
  "ground_truth": "...",
  "context": [...],
  "gold_doc_ids": ["7", "23", "42"]  // æ‰‹åŠ¨æ·»åŠ 
}
```

### æ ‡æ³¨æŠ€å·§

âœ… **åº”è¯¥æ ‡è®°ä¸ºç›¸å…³çš„chunk**ï¼š
- åŒ…å«å›ç­”é—®é¢˜æ‰€éœ€çš„å…³é”®ä¿¡æ¯
- ç›´æ¥æ”¯æŒground_truthä¸­çš„é™ˆè¿°
- æä¾›å¿…è¦çš„èƒŒæ™¯çŸ¥è¯†

âŒ **ä¸åº”æ ‡è®°çš„chunk**ï¼š
- åªæ˜¯æåˆ°ç›¸åŒä¸»é¢˜ä½†ä¸ç›´æ¥å›ç­”é—®é¢˜
- è¿‡äºå®½æ³›æˆ–ä¸å¤Ÿå…·ä½“
- ä¸é—®é¢˜æ— å…³çš„å†…å®¹

---

## â–¶ï¸ è¿è¡Œè¯„ä¼°

### åŸºç¡€ç”¨æ³•

```bash
cd evaluation
python run_evaluation.py
```

### é«˜çº§é€‰é¡¹

```python
# åœ¨ Python è„šæœ¬ä¸­è°ƒç”¨
from evaluation import run_enhanced_evaluation

results = run_enhanced_evaluation(
    dataset_path="eval_dataset.json",  # æ•°æ®é›†è·¯å¾„
    output_dir="eval_results",          # è¾“å‡ºç›®å½•
    max_samples=None                    # é™åˆ¶æ ·æœ¬æ•°ï¼ˆNone=å…¨éƒ¨ï¼‰
)
```

### è¾“å‡ºæ–‡ä»¶

è¯„ä¼°å®Œæˆåï¼Œä¼šåœ¨ `eval_results/` ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

```
eval_results/
â”œâ”€â”€ evaluation_summary_YYYYMMDD_HHMMSS.json  # æ±‡æ€»æŒ‡æ ‡
â”œâ”€â”€ performance_results_YYYYMMDD_HHMMSS.csv  # æ¯ä¸ªé—®é¢˜çš„è¯¦ç»†ç»“æœ
â””â”€â”€ ragas_results_YYYYMMDD_HHMMSS.csv        # RAGASè¯¦ç»†ç»“æœ
```

---

## ğŸ“ˆ è§£è¯»è¯„ä¼°ç»“æœ

### ç¤ºä¾‹è¾“å‡º

```
==================================================================
ENHANCED EVALUATION SUMMARY
==================================================================

Samples: 30

ã€RAGAS Metricsã€‘(0-1, higher better)
  faithfulness      : 0.9543
  answer_relevancy  : 0.7735
  context_precision : 0.9667
  context_recall    : 0.8833
  Average           : 0.8945

ã€System Performance Metricsã€‘
  Latency (p50/p95/mean): 6.87s / 10.04s / 7.58s
  Tokens (mean/p95):      3562 / 4129
  Success Rate:           100.0%
  Failure Rate:           0.0%

ã€Retrieval Hard Metricsã€‘(requires gold_doc_ids)
  hit@1_mean        : 0.6400
  recall@1_mean     : 0.5600
  hit@3_mean        : 1.0000
  recall@3_mean     : 0.9600
  hit@5_mean        : 1.0000
  recall@5_mean     : 0.9600
  mrr_mean          : 0.8067
```

### æŒ‡æ ‡è§£è¯»

#### ğŸŸ¢ ä¼˜ç§€çš„ç»“æœ

ä¸Šé¢çš„ç»“æœè¡¨æ˜ï¼š

1. **RAGAS å¹³å‡ 0.8945** â†’ ç³»ç»Ÿæ•´ä½“è´¨é‡å¾ˆé«˜
   - Faithfulness 0.95 â†’ ç­”æ¡ˆéå¸¸å¿ å®äºä¸Šä¸‹æ–‡
   - Context Precision 0.97 â†’ æ£€ç´¢éå¸¸ç²¾å‡†
   - Answer Relevancy 0.77 â†’ ç­”æ¡ˆç›¸å…³æ€§è‰¯å¥½ï¼Œæœ‰æå‡ç©ºé—´

2. **Hit@3 = 1.0** â†’ åœ¨å‰3ä¸ªæ£€ç´¢ç»“æœä¸­ï¼Œ100%åŒ…å«ç›¸å…³æ–‡æ¡£
3. **MRR = 0.81** â†’ å¹³å‡åœ¨ç¬¬1.2ä¸ªä½ç½®å°±èƒ½æ‰¾åˆ°ç›¸å…³æ–‡æ¡£
4. **Success Rate 100%** â†’ æ‰€æœ‰æŸ¥è¯¢éƒ½æˆåŠŸå®Œæˆ

#### ğŸŸ¡ éœ€è¦æ”¹è¿›çš„ä¿¡å·

- **Answer Relevancy < 0.7**: å¯èƒ½LLMç”Ÿæˆçš„ç­”æ¡ˆåç¦»äº†é—®é¢˜
- **Context Recall < 0.8**: æ£€ç´¢å¯èƒ½é—æ¼äº†é‡è¦ä¿¡æ¯
- **Hit@1 < 0.5**: æœ€ç›¸å…³çš„æ–‡æ¡£æ’åä¸å¤Ÿé å‰
- **Latency p95 > 15s**: ç³»ç»Ÿå“åº”è¾ƒæ…¢

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. è¿­ä»£è¯„ä¼°æµç¨‹

```
å‡†å¤‡æ•°æ®é›† â†’ è¿è¡Œè¯„ä¼° â†’ åˆ†æç»“æœ â†’ ä¼˜åŒ–ç³»ç»Ÿ â†’ é‡æ–°è¯„ä¼°
```

### 2. æ•°æ®é›†è®¾è®¡å»ºè®®

- **æ ·æœ¬æ•°é‡**ï¼šè‡³å°‘20-30ä¸ªé—®é¢˜ï¼Œèƒ½è¦†ç›–ä¸åŒç±»å‹
- **éš¾åº¦åˆ†å¸ƒ**ï¼šç®€å•ã€ä¸­ç­‰ã€å›°éš¾é—®é¢˜å„å 1/3
- **é—®é¢˜ç±»å‹**ï¼šäº‹å®å‹ã€æ¨ç†å‹ã€æ€»ç»“å‹ç­‰å¤šæ ·åŒ–

### 3. æ ‡æ³¨ gold_doc_ids çš„æ—¶æœº

å»ºè®®åœ¨ä»¥ä¸‹æƒ…å†µæ ‡æ³¨ï¼š
- âœ… URLåˆ—è¡¨å·²ç»å›ºå®šï¼Œä¸ä¼šå†å˜åŒ–
- âœ… å‡†å¤‡æ­£å¼è¯„ä¼°æˆ–å†™æŠ¥å‘Š
- âœ… éœ€è¦å®¢è§‚å¯¹æ¯”ä¸åŒæ£€ç´¢ç­–ç•¥

å¯ä»¥è·³è¿‡çš„æƒ…å†µï¼š
- ä»…åšå¿«é€Ÿæµ‹è¯•
- URLåˆ—è¡¨ç»å¸¸å˜åŒ–ï¼ˆchunk_idä¼šå˜ï¼‰
- åªå…³å¿ƒç”Ÿæˆè´¨é‡ï¼Œä¸å…³å¿ƒæ£€ç´¢å‡†ç¡®æ€§

### 4. ä¼˜åŒ–ç­–ç•¥

æ ¹æ®æŒ‡æ ‡é€‰æ‹©ä¼˜åŒ–æ–¹å‘ï¼š

| æŒ‡æ ‡ä½ | å¯èƒ½åŸå›  | ä¼˜åŒ–æ–¹å‘ |
|--------|----------|----------|
| Faithfulness | LLMå¹»è§‰ | æ”¹è¿›promptï¼Œå¼ºè°ƒ"ä»…åŸºäºä¸Šä¸‹æ–‡" |
| Answer Relevancy | ç­”æ¡ˆåé¢˜ | ä¼˜åŒ–promptï¼Œæ˜ç¡®å›ç­”è¦æ±‚ |
| Context Precision | æ£€ç´¢å™ªéŸ³ | è°ƒæ•´æ£€ç´¢ç­–ç•¥ï¼Œæé«˜ç›¸å…³æ€§é˜ˆå€¼ |
| Context Recall | æ£€ç´¢ä¸å…¨ | å¢åŠ æ£€ç´¢æ•°é‡ï¼Œæ”¹è¿›query rewriting |
| Hit@k / MRR | æ’åºä¸ä½³ | ä¼˜åŒ–embeddingæ¨¡å‹ï¼Œè°ƒæ•´æ£€ç´¢å‚æ•° |

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¿…é¡»æ ‡æ³¨ gold_doc_ids å—ï¼Ÿ

**A**: ä¸æ˜¯å¿…é¡»çš„ã€‚æ²¡æœ‰ `gold_doc_ids`ï¼š
- âœ… RAGAS æŒ‡æ ‡æ­£å¸¸å·¥ä½œ
- âœ… ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡æ­£å¸¸å·¥ä½œ
- âŒ æ£€ç´¢ç¡¬æŒ‡æ ‡æ— æ³•è®¡ç®—

å¦‚æœæ‚¨åªå…³å¿ƒç­”æ¡ˆè´¨é‡å’Œç³»ç»Ÿæ€§èƒ½ï¼Œå¯ä»¥è·³è¿‡æ ‡æ³¨ã€‚

### Q2: ä¸ºä»€ä¹ˆ Context Precision = 1.0ï¼Ÿ

**A**: å¸¸è§äºå°æ ·æœ¬è¯„ä¼°ã€‚Context Precision æµ‹é‡çš„æ˜¯"æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ä¸­æœ‰å¤šå°‘æ˜¯çœŸæ­£ç›¸å…³çš„"ã€‚åœ¨æ ·æœ¬é‡å°æˆ–æ£€ç´¢è´¨é‡é«˜æ—¶ï¼Œå®¹æ˜“å‡ºç°æ»¡åˆ†ã€‚è¿™ä¸æ˜¯é”™è¯¯ï¼Œä½†å»ºè®®ï¼š
- å¢åŠ æ ·æœ¬é‡åˆ°30+
- åŒ…å«æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜
- æ ‡æ³¨ gold_doc_ids è·å¾—æ›´å®¢è§‚çš„æŒ‡æ ‡

### Q3: è¯„ä¼°éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

**A**: å–å†³äºæ ·æœ¬æ•°é‡ï¼š
- 10ä¸ªé—®é¢˜ï¼šçº¦1-2åˆ†é’Ÿ
- 30ä¸ªé—®é¢˜ï¼šçº¦3-5åˆ†é’Ÿ
- 100ä¸ªé—®é¢˜ï¼šçº¦10-15åˆ†é’Ÿ

æ¯ä¸ªé—®é¢˜å¹³å‡è€—æ—¶6-10ç§’ï¼ˆåŒ…æ‹¬æ£€ç´¢+ç”Ÿæˆ+è¯„ä¼°ï¼‰ã€‚

### Q4: å¦‚ä½•é€‰æ‹©è¯„ä¼°é—®é¢˜ï¼Ÿ

**A**: å¥½çš„è¯„ä¼°æ•°æ®é›†åº”è¯¥ï¼š
1. **ä»£è¡¨æ€§**: è¦†ç›–å®é™…ç”¨æˆ·ä¼šé—®çš„é—®é¢˜ç±»å‹
2. **å¤šæ ·æ€§**: ä¸åŒéš¾åº¦ã€ä¸åŒä¸»é¢˜
3. **å¯éªŒè¯æ€§**: ground_truth åº”è¯¥æ˜ç¡®ä¸”å¯éªŒè¯

é¿å…ï¼š
- è¿‡äºç®€å•æˆ–å¸¸è¯†æ€§çš„é—®é¢˜
- æ¨¡ç³Šä¸æ¸…çš„é—®é¢˜
- éœ€è¦å¤–éƒ¨çŸ¥è¯†æ‰èƒ½å›ç­”çš„é—®é¢˜ï¼ˆè¶…å‡ºæ•°æ®æºèŒƒå›´ï¼‰

### Q5: chunk_id æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Ÿ

**A**: `chunk_id` åœ¨æ„å»ºå‘é‡åº“æ—¶è‡ªåŠ¨åˆ†é…ï¼š
```python
# rag_agent/vectorstore.py
d.metadata["chunk_id"] = str(idx)  # æŒ‰ç´¢å¼•é¡ºåºåˆ†é…
```

**é‡è¦**ï¼šå¦‚æœ `urls.txt` æ”¹å˜æˆ–æ–‡æ¡£é‡æ–°åŠ è½½ï¼Œchunk_id ä¼šå˜åŒ–ï¼å› æ­¤ï¼š
- æ ‡æ³¨ gold_doc_ids å‰ï¼Œç¡®ä¿ urls.txt å·²å›ºå®š
- å¦‚æœé‡å»ºäº†å‘é‡åº“ï¼Œéœ€è¦é‡æ–°æ ‡æ³¨

### Q6: è¯„ä¼°å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: å¸¸è§é—®é¢˜ï¼š

1. **`ModuleNotFoundError`**: 
   ```bash
   pip install -r requirements.txt
   ```

2. **API Keyé”™è¯¯**:
   ```bash
   $env:GOOGLE_API_KEY='your_key'  # Windows
   export GOOGLE_API_KEY='your_key'  # Mac/Linux
   ```

3. **å†…å­˜ä¸è¶³**: å‡å°‘æ ·æœ¬æ•°
   ```python
   run_enhanced_evaluation(max_samples=10)
   ```

### Q7: å¦‚ä½•åœ¨ç®€å†/æŠ¥å‘Šä¸­å±•ç¤ºè¯„ä¼°ç»“æœï¼Ÿ

**A**: æ¨èæ ¼å¼ï¼š

```markdown
## RAGç³»ç»Ÿè¯„ä¼°ç»“æœ

åœ¨åŒ…å«30ä¸ªç”Ÿç‰©åŒ»å­¦é¢†åŸŸé—®é¢˜çš„æµ‹è¯•é›†ä¸Šè¯„ä¼°ï¼š

**ç”Ÿæˆè´¨é‡ï¼ˆRAGASæŒ‡æ ‡ï¼‰**ï¼š
- Faithfulness: 0.95ï¼ˆç­”æ¡ˆå¿ å®åº¦ï¼‰
- Context Precision: 0.97ï¼ˆæ£€ç´¢ç²¾å‡†åº¦ï¼‰
- ç»¼åˆè¯„åˆ†: 0.89/1.0

**æ£€ç´¢æ€§èƒ½ï¼ˆå®¢è§‚æŒ‡æ ‡ï¼‰**ï¼š
- Hit@3: 100%ï¼ˆå‰3ä¸ªç»“æœå‘½ä¸­ç‡ï¼‰
- MRR: 0.81ï¼ˆå¹³å‡å€’æ•°æ’åï¼‰

**ç³»ç»Ÿæ€§èƒ½**ï¼š
- å¹³å‡å“åº”æ—¶é—´: 7.6ç§’
- æˆåŠŸç‡: 100%
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ENHANCED_EVALUATION_GUIDE.md](docs/ENHANCED_EVALUATION_GUIDE.md) - è¯„ä¼°ç³»ç»Ÿè¯¦ç»†è¯´æ˜
- [GOLD_DOC_IDS_GUIDE.md](docs/GOLD_DOC_IDS_GUIDE.md) - gold_doc_ids æ ‡æ³¨æŒ‡å—
- [EVALUATION_INDEX.md](docs/EVALUATION_INDEX.md) - è¯„ä¼°æ–‡æ¡£ç´¢å¼•

---

## ğŸ“ æ€»ç»“

è¯„ä¼°æ˜¯æ”¹è¿› RAG ç³»ç»Ÿçš„å…³é”®ï¼š

1. âœ… **å‡†å¤‡**: åˆ›å»ºé«˜è´¨é‡çš„è¯„ä¼°æ•°æ®é›†
2. âœ… **æ ‡æ³¨**: ä½¿ç”¨å·¥å…·æ ‡æ³¨ gold_doc_idsï¼ˆå¯é€‰ä½†æ¨èï¼‰
3. âœ… **è¿è¡Œ**: `python run_evaluation.py`
4. âœ… **åˆ†æ**: è§£è¯»ä¸‰ç±»æŒ‡æ ‡ï¼Œæ‰¾å‡ºç“¶é¢ˆ
5. âœ… **ä¼˜åŒ–**: é’ˆå¯¹æ€§æ”¹è¿›ï¼Œé‡æ–°è¯„ä¼°

è®°ä½ï¼š**è¯„ä¼°ä¸æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè€Œæ˜¯æŒç»­è¿­ä»£çš„è¿‡ç¨‹**ã€‚

---

*æœ€åæ›´æ–°: 2026-01-24*
